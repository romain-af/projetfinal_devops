<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Task Manager</title>
</head>
<body>
  <h1>Task Manager</h1>
  <form id="taskForm">
    <input type="text" id="title" placeholder="Titre de la tâche" required>
    <input type="text" id="description" placeholder="Description">
    <button type="submit">Ajouter</button>
  </form>
  <h2>Liste des tâches</h2>
  <ul id="taskList"></ul>

  <script>
    // Fonction pour afficher les tâches dans la liste
    function afficherTaches(taches) {
      const taskList = document.getElementById('taskList');
      taskList.innerHTML = ''; // vider la liste
      taches.forEach(tache => {
        const li = document.createElement('li');
        li.textContent = `${tache.title} : ${tache.description}`;
        taskList.appendChild(li);
      });
    }

    // Récupérer les tâches depuis le backend
    function fetchTasks() {
      fetch('http://localhost:8000/tasks')
        .then(response => response.json())
        .then(data => afficherTaches(data))
        .catch(error => console.error('Erreur lors de la récupération des tâches :', error));
    }

    // Gestion de l'envoi du formulaire pour ajouter une tâche
    document.getElementById('taskForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const title = document.getElementById('title').value;
      const description = document.getElementById('description').value;
      // Vous pouvez générer un id automatiquement pour la démo ou laisser l'utilisateur le saisir
      const id = Date.now(); // par exemple, utiliser l'horodatage comme id

      fetch('http://localhost:8000/tasks', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id, title, description })
      })
      .then(response => response.json())
      .then(data => {
        console.log('Tâche ajoutée :', data);
        // Actualiser la liste des tâches après l'ajout
        fetchTasks();
      })
      .catch(error => console.error('Erreur lors de l’ajout de la tâche :', error));
    });

    // Charger les tâches dès le chargement de la page
    fetchTasks();
  </script>
</body>
</html>
